<?php/*------------------------------------------------------------------------# JoomSport Professional # ------------------------------------------------------------------------# BearDev development company # Copyright (C) 2011 JoomSport.com. All Rights Reserved.# @license - http://joomsport.com/news/license.html GNU/GPL# Websites: http://www.JoomSport.com # Technical Support:  Forum - http://joomsport.com/helpdesk/-------------------------------------------------------------------------*/// no direct accessdefined( '_JEXEC' ) or die( 'Restricted access' );JHtml::_('behavior.tooltip');JHTML::_('behavior.formvalidation');$editor = JFactory::getEditor();$Itemid = JRequest::getInt('Itemid');//update$this->lists["player_reg"] = array();if(count($this->lists["player_reg"])){    for($i=0;$i<count($this->lists["player_reg"]);$i++){        foreach($this->lists["player_reg"][$i] as $dta){            $tmp[$i][]='\''.addslashes($dta).'\'';        }    }    for($j=0;$j<count($tmp);$j++){        $arr1[] = $tmp[$j][0];        $arr2[] = $tmp[$j][1];    }}    $fname = isset($arr1)?implode(',',$arr1):('');    $lname = isset($arr2)?implode(',',$arr2):('');?><script type="text/javascript">			function delete_logo(){		getObj("logoiddiv").innerHTML = '';	}			function confirmDelete(){		var fName = document.getElementsByName('first_name')[0].value; 		var lName = document.getElementsByName('last_name')[0].value; 		var msg = '';		var arrFName = new Array(<?php echo $fname;?>);		var arrLName = new Array(<?php echo $lname;?>);							for(var i=0;i<arrFName.length;i++){				if(arrFName[i] == fName && arrLName[i] == lName){					 msg = 1;				}							}						var indf = <?php echo (isset($this->lists["usr"]->last_name) && isset($this->lists["usr"]->first_name))?(1):(0); ?>;			if(msg && indf == 0){				if (confirm("Player with such First Name and Last Name already exist. Do you wants to continue?")) {					return true;				} else {					return false;				}			}	}</script><?phpecho $this->lists["panel"];?><form action="<?php echo 'index.php?option=com_joomsport&task=regplayer&Itemid='.$Itemid ; ?>" method="post" name="adminForm" id="adminForm" enctype="multipart/form-data"><!-- <module middle> -->	<div class="module-middle solid">				<!-- <back box> -->		<!--<div class="back dotted"><a href="#" title="Back">&larr; Back</a></div>-->		<!-- </back box> -->				<!-- <title box> -->		<div class="title-box">			<h2><?php echo $this->escape($this->ptitle); ?></h2>						<?php if(isset($this->lists["ed_seas"])):?>			<div class="select-wr" style="display: table;">                <span style="display: table-cell;"><?php echo $this->lists['tourn_name']; ?></span>				<form action='' method='post' name='chg_seas ' style="display: table-cell;">					<div style="position:relative;text-align: right;margin-left:40px;"><span class='down'><!-- --></span><?php echo $this->lists['ed_seas'];?></div>				</form>			</div>			<?php endif;?>		</div>		<!-- </div>title box> -->				<!-- <tab box> -->			<?php if($this->lists["enmd"]):?>			<ul class="tab-box">			<li class="active"><a href="<?php echo JRoute::_('index.php?option=com_joomsport&task=regplayer&Itemid='.$Itemid);?>" title=""><span><img src="<?php echo JURI::base();?>components/com_joomsport/img/spacer.gif" class="players" width="16" height="16" /><?php echo JText::_('BL_TAB_PLAYER');?></span></a></li>			<li><a href="<?php echo JRoute::_( 'index.php?option=com_joomsport&task=moderedit_umatchday&Itemid='.$Itemid )?>" title=""><span><img src="<?php echo JURI::base();?>components/com_joomsport/img/spacer.gif" width="16" height="16" /><?php echo JText::_('BLFA_MATCHDAY')?></span></a></li>			</ul>			<?php endif;?>		<!-- </tab box> -->			</div></form>	<!-- </module middle> -->	<!-- <content module> -->	<form method="POST" action="<?php echo 'index.php?option=com_joomsport&task=playerreg_save&Itemid='.$Itemid ; ?>" enctype="multipart/form-data" class="form-validate" id="regpl-form">	<div class="content-module">			<table class="season-list" cellpadding="0" cellspacing="0" border="0">			<tr>				<td><b><?php echo JText::_('BL_FIRSTNAME');?> *:</b></td>				<td><input type="text" class="feed-back inp-big required" name="first_name" value="<?php echo (isset($this->lists["usr"]->first_name)?htmlspecialchars($this->lists["usr"]->first_name):"")?>" /></td>			</tr>			<?php if($this->lists['reg_lastname']){?>			<tr>				<td><b><?php echo JText::_('BL_LASTNAME');?> <?php echo $this->lists['reg_lastname_rq']?" *":"";?>:</b></td>				<td><input type="text" class="feed-back inp-big <?php echo $this->lists['reg_lastname_rq']?" required":"";?>" name="last_name" value="<?php echo (isset($this->lists["usr"]->last_name)?htmlspecialchars($this->lists["usr"]->last_name):"")?>" /></td>			</tr>			<?php } ?>			<?php if($this->lists['nick_reg']){?>			<tr>				<td><b><?php echo JText::_('BL_NICK');?><?php echo $this->lists['nick_reg_rq']?" *":"";?>:</b></td>				<td><input type="text" class="feed-back inp-big <?php echo $this->lists['nick_reg_rq']?" required":"";?>" name="nick" value="<?php echo (isset($this->lists["usr"]->nick)?htmlspecialchars($this->lists["usr"]->nick):"")?>" /></td>			</tr>			<?php } ?>			<?php if($this->lists['country_reg']){?>			<tr>				<td><b><?php echo JText::_('BL_COUNTRY');?><?php echo $this->lists['country_reg_rq']?" *":"";?>:</b></td>				<td><div class="selectsty"><span class="down"><!-- --></span><?php echo $this->lists["country"]?></div></td>			</tr>			<?php } ?>			<?php		//print_r($this->lists["seas_pl_reg"]);			for($i=0;$i<count($this->lists["adf"]);$i++){				$adfs = $this->lists["adf"][$i];				if( $this->lists["adf"][$i]->season_related && $this->sid){ //isset($this->lists['seas_pl_reg']) && $this->lists['seas_pl_reg'] == 1 &&					echo '<tr><td><input type="hidden" name="extra_id['.$adfs->id.']" value="'.$adfs->id.'" /><input type="hidden" name="extra_ftype['.$adfs->id.']" value="'.$adfs->field_type.'" /><b>'.$adfs->name.($adfs->reg_require?' *':"").':</b></td>';					echo '<td>';					switch($adfs->field_type){																		case '1':	echo $adfs->selvals;									break;						case '2':	echo $this->editor->display( 'extraf['.$adfs->id.']',  htmlspecialchars(isset($adfs->fvalue_text)?($adfs->fvalue_text):"", ENT_QUOTES), '550', '300', '60', '20', array('pagebreak', 'readmore', 'image') ) ;									break;						case '3':	echo '<div class="selectsty"><span class="down"><!-- --></span>'.$adfs->selvals.'</div>';									break;							case '0':											default:	echo '<input type="text" class="feed-back inp-big'.($adfs->reg_require?' required':'').'" maxlength="255" size="60" name="extraf['.$adfs->id.']" value="'.(isset($adfs->fvalue)?htmlspecialchars($adfs->fvalue):"").'" />';											break;												}																								}else if( $this->lists["adf"][$i]->season_related == 0 && $adfs->reg_exist){ //empty($this->lists['seas_pl_reg'])  &&															echo '<tr><td><input type="hidden" name="extra_id['.$adfs->id.']" value="'.$adfs->id.'" /><input type="hidden" name="extra_ftype['.$adfs->id.']" value="'.$adfs->field_type.'" /><b>'.$adfs->name.($adfs->reg_require?' *':"").':</b></td>';					echo '<td>';					switch($adfs->field_type){																		case '1':	echo $adfs->selvals;									break;						case '2':	echo $this->editor->display( 'extraf['.$adfs->id.']',  htmlspecialchars(isset($adfs->fvalue_text)?($adfs->fvalue_text):"", ENT_QUOTES), '550', '300', '60', '20', array('pagebreak', 'readmore', 'image') ) ;									break;						case '3':	echo '<div class="selectsty"><span class="down"><!-- --></span>'.(isset($adfs->selvals)?$adfs->selvals:'').'</div>';									break;							case '0':											default:	echo '<input type="text" class="feed-back inp-big'.($adfs->reg_require?' required':'').'" maxlength="255" size="60" name="extraf['.$adfs->id.']" value="'.(isset($adfs->fvalue)?htmlspecialchars($adfs->fvalue):"").'" />';											break;					}																	}																	echo '</td></tr>';			}			?>            <tr>                <td width="100">                    <b><?php echo JText::_( 'BLFA_ABOUT_PLAYER' ); ?></b>                    <!--<span class="editlinktip hasTip" title="<?php echo JText::_( 'BLFA_ABOUT_PLAYER' ); ?>::<?php echo JText::_( 'BLFA_TT_ABOUT_PLAYER' );?>"><img src="components/com_joomsport/img/quest.jpg" bOrder="0" /></span>-->                </td>                <td>                    <?php echo $editor->display( 'about',  htmlspecialchars($this->lists["usr"]->about, ENT_QUOTES), '100%', '300', '60', '20', array('pagebreak', 'readmore') ) ;  ?>                </td>            </tr>			<tr>				<td><b><?php echo JText::_('BLFA_UPLOADPHOT');?>:</b></td>				<td>					<input type="file" name="player_photo_1" value="" class="feed-back inp-small" id="player_photo_1"/>					<button class="send-button" id="player_photo"><span><?php echo JText::_( 'BLFA_UPLOAD' ); ?></span></button>									</td>			</tr>		</table>        <script type="text/javascript">            var photo1 = document.getElementById("player_photo_1");            var but_on = document.getElementById("player_photo");            var serv_sett = <?php echo $this->lists['post_max_size'];?>;            but_on.onclick = function() {                if(photo1.files[0]){                    var size_img =  photo1.files[0].size;                }                if(size_img > serv_sett){                    alert("Image too big (change settings post_max_size)"); return false;                }else{submitbutton('playerreg_save');}            };        </script>		<?php				if(isset($this->lists['photos']) && count($this->lists['photos'])){		?>		<table class="adminlist admin-mo-co" cellpadding="0" cellspacing="0" border="0">			<tr>				<th class="title" width="30"><?php echo JText::_('BLFA_DELETE')?></th>				<th class="title" width="30"><?php echo JText::_('BLFA_DEFAULT')?></th>				<th class="title" ><?php echo JText::_('BLFA_TITLE')?></th>				<th class="title" width="250"><?php echo JText::_('BLFA_IMAGE')?></th>			</tr>			<?php			foreach($this->lists['photos'] as $photos){			?>			<td align="center">				<a href="javascript:void(0);" title="<?php echo JText::_('BLFA_REMOVE')?>" onClick="javascript:Delete_tbl_row(this);"><img src="<?php echo JURI::base();?>components/com_joomsport/img/ico/close.png" title="<?php echo JText::_('BLFA_REMOVE')?>" /></a>			</td>			<td align="center">				<?php				$ph_checked = ($this->lists["usr"]->def_img == $photos->id) ? 'checked="true"' : "";								?>				<input type="radio" name="ph_default" value="<?php echo $photos->id;?>" <?php echo $ph_checked?>/>				<input type="hidden" name="photos_id[]" value="<?php echo $photos->id;?>"/>			</td>			<td>				<input type="text" maxlength="255" size="60" class="inputtext" name="ph_names[]" value="<?php echo htmlspecialchars($photos->name)?>" />			</td>			<td align="center">				<?php				$imgsize = getimagesize('media/bearleague/'.$photos->filename);				if($imgsize[0] > 200){					$width = 200;				}else{					$width  = $imgsize[0];				}				?>				<a rel="lightbox-imgsport" href="<?php echo getImgPop($photos->filename)?>" title="Image"><img src="<?php echo JURI::base();?>media/bearleague/<?php echo $photos->filename?>" width="<?php echo $width;?>" /></a>			</td>			</tr>			<?php			}			?>		</table>		<?php		}		?>		<table class="season-list" width="100%" cellpadding="0" cellspacing="0" border="0">			<tr>				<td style="text-align:center;"><span onclick="return confirmDelete();"><button class="send-button validate button" type="submit" onClick="return document.formvalidator.isValid(document.id('regpl-form'));"><span><b><?php echo JText::_('BL_SEND');?></b></span></button></td>			</tr>		</table>			</div>	<input type="hidden" name="id" value="<?php echo (isset($this->lists["usr"]->id)?$this->lists["usr"]->id:0)?>" />	<input type="hidden" name="return" value="<?php echo (isset($this->lists["return"])?$this->lists["return"]:'')?>" />	<input type="hidden" name="sid" value="<?php echo (isset($this->sid)?$this->sid:0)?>" />	</form>	<!-- </content module> -->